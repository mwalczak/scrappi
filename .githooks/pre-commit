#!/bin/bash

# Git pre-commit hook to run Deptrac architecture checks
# This ensures architectural boundaries are respected before each commit

echo "üîç Running Deptrac architecture checks..."

# Run Deptrac using the helper script
if ! ./deptrac analyze --config-file=deptrac.yaml --no-progress; then
    echo ""
    echo "‚ùå Deptrac found architectural violations!"
    echo "   Please fix the violations before committing."
    echo ""
    echo "   To see detailed violations, run: ./deptrac analyze"
    echo "   To bypass this check (not recommended): git commit --no-verify"
    echo ""
    exit 1
fi

echo "‚úÖ Deptrac checks passed!"
exit 0
